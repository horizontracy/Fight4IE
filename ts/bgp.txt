ts bgp
题目
截图如下
r12# tracerout 8.8.8.8 pr 2
type escape sequence to abort
tracing the route to 8.8.8.8
vf info: (vrf in name/id, vrf out name/id)
1	123.45.67.45 1 msec
 	123.45.67.46 0 msec
2 	123.45.67.9 [AS 12345] [MPLS: Label 24 Exp 0] 1 msec
 	123.45.67.13 [AS 12345] [MPLS: Label 24 Exp 0] 1 msec
3 		     .1
4 			 .6
5 		   78.38
6 		   78.6

r12# traceroute 194.1.1.1 pr 2
1 	123.45.67.45
 	123.45.67.46
2 			 .9
			 .13
3 			 .1
4 			 .18
5 		  .78.42
6 		  .78.14

r12# traceroute 123.3.3.3
1 	123.45.67.45
2 	123.45.67.9
3 			 .1
4 			 .6

r12# traceroute 134.21.21.21
1 	123.45.67.46
2 	123.45.67.13
3 			 .6
4 			 .38

错误点
1. r12没有开启maximum－path 2
2. 修改r22的route-map inet使194.1.1.0/24的路由不被设置metric
3. r22指向r5没做next-hop-self
4. 修改r4或者r6的route-map，使得134.1.1.0/24路由在r12上不负载

［详解］
本题难度较大，要求对选路了解
题目要求r12需要trace r26的2个地址、r21的lo0、r3的lo0，给出了trace路径截图

在r12上，因为整个路由都是靠bgp传递，因此常看bgp路由
sh ip bgp
可以看到
8.8.8.8/24 	＃已经学到了8.8.8.8
194.1.1.0 	＃
134.21.21.21 	 #r21 lo 0
123.3.3.3 	#r3 lo 0

题外话：
这里的bgp路由没有问题
考试时候如果学不到路由，那么重点关注以下几点：
r21和r22：这两台设备负责把从r26学到的路由发送给内部r3、r5，因为area1和area0是2个area，需要配next-hop-self
目前考试中出现的没有路由的错点仅此一种

路由送入r3和r5后，r3和r5是路由反射器，r3会反射路由给r4和r6，r5也是。目前反射器上没有出现错点。

目前路由都学到了，因此在r12上逐个trace，看路径是否正确
先trace 8.8.8.8，默认的trace是每一跳发3个包，这里用probe 2，即每一跳发送2个包，如果正确，可以看到r4和r6负载分担
看到第一跳选了.45，没有负载分担
查看bgp表，看为什么选了.45
sh ip bgp 8.8.8.8 	#看8.8.8.8这条路由的详细参数，这里有个8项参数
看到.45和.46的路由，不同之处在于：.45有'best'
发现所有参数都一致，即8项参数都一致，这里已经满足负载分担的前提了，怀疑maximum-path开关没有开
sh run | se bgp
发现没有做maximum-path
router bgp 14567
address-family ipv4
maximum-path 2
再show bgp路由表
sh ip bgp
看到8.8.8.8前面多了一个‘m’，说明是‘multipath’
再在路由表中确认8.8.8.8为路由分担了
sh ip route 	#看到路由负载分担，要trace出负载分担，路由表中一定是负载分担的
再trace一次验证，对比截图，每一跳都是一致的，8.8.8.8解决

再trace 194.1.1.1 probe 2
(未完待续。。。视频9:50)